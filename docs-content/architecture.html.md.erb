---
title: Product Architecture
owner: Windows
---

This topic describes the architecture of Windows cells that PAS for Windows deploys to run containerized .NET apps, and the stemcells that it supplies to BOSH as the operating system for the Windows cell VMs.

## <a id='overview'></a>Overview

Operators who want to run Windows cells in PCF to enable developers to push .NET apps can deploy the PAS for Windows tile.

Deploying this tile creates a separate BOSH deployment populated with the Garden Windows release, which runs on a Windows cell built from a Windows stemcell.

Once the Windows cell is running, developers can specify a Windows stack when pushing .NET apps from the command line. PCF passes the app to the Windows cell in the Garden Windows BOSH deployment. The diagram below illustrates the process.

<%= image_tag('windows-overview.png') %>

## <a id="cells"></a> About Windows Cells

App instances in PCF run inside containers. [Garden](https://docs.pivotal.io/pivotalcf/concepts/architecture/garden.html) is the API that creates and manages these containers, and Garden Windows implements Garden on Windows.

By installing the [PAS for Windows](installing.html) tile, operators create a Windows [cell](https://docs.pivotal.io/pivotalcf/concepts/architecture/index.html#diego-cell) from a [stemcell](https://bosh.io/docs/stemcell.html) that contains the Windows Server operating system. Garden Windows uses [Windows Containers](https://docs.microsoft.com/en-us/virtualization/windowscontainers/about/) to isolate resources run Windows cells that Cloud Foundry manages alongside Linux cells.

### <a id="components"></a> Components

A Windows cell includes the following components:

* Garden Windows: Implements the [Garden](https://docs.pivotal.io/pivotalcf/concepts/architecture/garden.html) API on Windows
* [Metron Agent](https://docs.pivotal.io/pivotalcf/concepts/diego/diego-architecture.html#metron-agent): Forwards app logs, errors, and metrics to the [Loggregator](https://docs.pivotal.io/pivotalcf/loggregator/architecture.html) system
* [BOSH Agent](https://bosh.io/docs/bosh-components.html#agent): Executes instructions from the BOSH Director
* [Consul Client](https://docs.pivotal.io/pivotalcf/concepts/diego/diego-architecture.html#consul): Registers the cell as a service in a Consul cluster
* [Cell Rep](https://docs.pivotal.io/pivotalcf/concepts/diego/diego-architecture.html#rep): Runs and manages [Tasks and Long Running Processes](https://docs.pivotal.io/pivotalcf/concepts/diego/diego-auction.html#processes)

The following diagram illustrates the architecture of a Windows cell:

<%= image_tag('windows-cell.png') %>

### <a id="components"></a> Container Isolation

Garden Windows builds on [Windows Containers](https://docs.microsoft.com/en-us/virtualization/windowscontainers/about/) to isolate container filesystems, provide network namespace, and limit memory and CPU usage.

To limit container disk usage, Garden Windows enforces disk usage limits with NTFS [disk quotas](https://technet.microsoft.com/en-us/library/cc938945.aspx#XSLTsection128121120120), which work on a per-user, per-volume basis. The disk quotas apply to the isolated volume provided by Windows Containers, which by default is the `C:\` volume.

Because quotas are transparent to the user, the temporary user who owns the container can only see the disk resources available within the assigned quota.

## <a id="stemcells"></a> About Windows Stemcells

A "stemcell" is a customized operating system image containing the filesystem for BOSH-managed virtual machines. When deployed, the operating system includes the _BOSH Agent_ process, which is dedicated to communicating with the orchestrating VM, the _BOSH Director_.
The BOSH Agent executes and monitors BOSH jobs on its VM.

Deployments of Windows Server on PCF currently use a stemcell containing Windows Server 2016.

See [Downloading or Creating Windows Stemcells](./stemcells.html) for documentation about how to obtain or create a stemcell for PAS for Windows.
